<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Our Medicines - Bilawal Homoeopathic Clinic</title>

  <!-- SEO Meta -->
  <meta name="description" content="Bilawal Homoeopathic Clinic: safe natural remedies. Order by Cash on Delivery." />
  <meta name="robots" content="index, follow" />

  <!-- Styles (replace with your merged style.css afterwards) -->
  <link rel="stylesheet" href="style.css">
  <!-- Google font (Poppins) -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Header -->
  <header>
    <div class="logo">Bilawal Clinic</div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="products.html" class="active">Medicines</a></li>
        <li><a href="appointments.html">Appointments</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>

    <!-- Cart button (round badge) -->
    <div class="cart-wrap">
      <button id="openCartBtn" class="cart-icon" aria-label="Open cart">
        ðŸ›’
        <span id="cartCount" class="cart-count">0</span>
      </button>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <h1>Available Homoeopathic Medicines</h1>
    <p>Trusted homeopathic care â€” safe, natural, and evidence informed.</p>
  </section>

  <!-- Products Section -->
  <main class="products">
    <p class="subtitle">High-quality and authentic remedies for natural healing.</p>

    <div class="product-grid">
      <!-- Product 1 -->
      <div class="card">
        <img src="images/medicine1.jpg" alt="Arsenicum Album 30">
        <h3>Arsenicum Album 30</h3>
        <p class="short">Used for anxiety, cold/flu and digestive upset.</p>
        <p class="price">Rs 500</p>
        <div class="card-actions">
          <button class="desc-btn" onclick="openDescription('Arsenicum Album 30','Commonly used for anxiety, restlessness, chilly patients, burning pains, cold/flu symptoms and some digestive disturbances. Use under practitioner guidance.','Rs 500')">Description</button>
          <button class="add-btn" onclick="addToCart('Arsenicum Album 30',500,'images/medicine1.jpg')">Add to Cart</button>
        </div>
      </div>

      <!-- Product 2 -->
      <div class="card">
        <img src="images/medicine2.jpg" alt="Belladonna 30">
        <h3>Belladonna 30</h3>
        <p class="short">Helpful for sudden fever, sore throat and heat symptoms.</p>
        <p class="price">Rs 300</p>
        <div class="card-actions">
          <button class="desc-btn" onclick="openDescription('Belladonna 30','Useful in sudden high fever, flushed face, throbbing pains and sensitivity to light/noise. Use under practitioner guidance.','Rs 300')">Description</button>
          <button class="add-btn" onclick="addToCart('Belladonna 30',300,'images/medicine2.jpg')">Add to Cart</button>
        </div>
      </div>

      <!-- Product 3 -->
      <div class="card">
        <img src="images/medicine3.jpg" alt="Nux Vomica 30">
        <h3>Nux Vomica 30</h3>
        <p class="short">Used for digestive complaints, nausea and irritability.</p>
        <p class="price">Rs 400</p>
        <div class="card-actions">
          <button class="desc-btn" onclick="openDescription('Nux Vomica 30','Often indicated for indigestion, nausea, overwork-related symptoms, irritability and constipation. Follow dosage advice from your homeopath.','Rs 400')">Description</button>
          <button class="add-btn" onclick="addToCart('Nux Vomica 30',400,'images/medicine3.jpg')">Add to Cart</button>
        </div>
      </div>
    </div>
  </main>

  <!-- Description Modal -->
  <div id="descModal" class="modal" aria-hidden="true">
    <div class="modal-content">
      <span class="close-btn" onclick="closeDescription()" aria-label="Close description">&times;</span>
      <h3 id="descTitle"></h3>
      <p id="descText"></p>
      <p id="descPrice" style="font-weight:700;color:#0072ff;margin-top:12px"></p>
    </div>
  </div>

  <!-- Cart Modal (appointment-style checkout inside) -->
  <div id="cartModal" class="modal" aria-hidden="true">
    <div class="modal-content form-container">
      <span class="close-btn" onclick="closeCart()" aria-label="Close cart">&times;</span>

      <h2>Your Cart</h2>

      <div id="cartItemsWrapper">
        <!-- cart-items table will be injected here by JS -->
      </div>

      <div class="cart-summary" id="cartSummary" style="margin-top:14px; text-align:right; font-weight:700;">
        Total: Rs <span id="cartTotal">0</span>
      </div>

      <hr style="margin:18px 0; border:none; border-top:1px solid #eee">

      <h3 style="color:#0072ff; margin-bottom:10px">Checkout</h3>

      <!-- Checkout form (Web3Forms) -->
      <form id="checkoutForm" class="appointment-form" action="https://api.web3forms.com/submit" method="POST">
        <!-- Web3Forms access key (your key) -->
        <input type="hidden" name="access_key" value="ae943642-5d7b-48c2-927a-216d05b1360b">
        <!-- human-readable order details -->
        <input type="hidden" id="orderDetails" name="orderDetails">
        <!-- optional redirect (commented out) -->
        <!-- <input type="hidden" name="redirect" value="thankyou.html"> -->

        <div class="form-group">
          <label for="cust-name">Full Name</label>
          <input id="cust-name" name="name" type="text" placeholder="Full name" required>
        </div>

        <div class="form-group">
          <label for="cust-email">Email</label>
          <input id="cust-email" name="email" type="email" placeholder="Email address" required>
        </div>

        <div class="form-group">
          <label for="cust-phone">Phone</label>
          <input id="cust-phone" name="phone" type="tel" placeholder="Phone number" required>
        </div>

        <div class="form-group">
          <label for="cust-address">Full Address</label>
          <textarea id="cust-address" name="address" rows="3" placeholder="House, Street, City, Postal" required></textarea>
        </div>

        <div class="form-group">
          <label for="cust-delivery">Delivery Method</label>
          <select id="cust-delivery" name="delivery" required>
            <option value="Receive from Clinic">Receive from Clinic</option>
            <option value="Home Delivery (Cash on Delivery)">Home Delivery (Cash on Delivery)</option>
          </select>
        </div>

        <div class="form-group">
          <label for="cust-note">Special instructions (optional)</label>
          <textarea id="cust-note" name="note" rows="2" placeholder="E.g., preferred delivery time"></textarea>
        </div>

        <p class="fixed-note">Payment: <strong>Cash on Delivery</strong></p>

        <button type="submit">Place Order (Cash on Delivery)</button>
      </form>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <p>&copy; 2025 Bilawal Homoeopathic Clinic. All Rights Reserved.</p>
  </footer>

  <!-- JavaScript -->
  <script>
    // Load cart from localStorage
    let cart = JSON.parse(localStorage.getItem('bhc_cart') || '[]');

    // Utility: save and update UI
    function saveCart() {
      localStorage.setItem('bhc_cart', JSON.stringify(cart));
      updateCartUI();
    }

    function updateCartUI() {
      // update badge count
      const count = cart.reduce((sum, item) => sum + item.quantity, 0);
      const countEl = document.getElementById('cartCount');
      if (countEl) countEl.textContent = count;

      // build cart table HTML
      const wrapper = document.getElementById('cartItemsWrapper');
      if (!wrapper) return;

      if (cart.length === 0) {
        wrapper.innerHTML = '<p class="empty-note">Your cart is empty.</p>';
        document.getElementById('cartTotal').textContent = '0';
        document.getElementById('orderDetails').value = '';
        return;
      }

      let html = '<table class="cart-table"><thead><tr><th>Product</th><th>Price</th><th>Qty</th><th>Subtotal</th><th></th></tr></thead><tbody>';
      let total = 0;
      cart.forEach((it, idx) => {
        const subtotal = it.price * it.quantity;
        total += subtotal;
        html += `<tr>
          <td style="display:flex;align-items:center;gap:8px;">
            ${ it.img ? `<img src="${it.img}" alt="${escapeHtml(it.name)}" style="width:50px;height:50px;border-radius:6px;object-fit:cover;">` : '' }
            <div style="text-align:left;">${escapeHtml(it.name)}</div>
          </td>
          <td>Rs ${it.price}</td>
          <td>
            <button class="qty-btn" onclick="changeQty(${idx}, -1)">-</button>
            ${it.quantity}
            <button class="qty-btn" onclick="changeQty(${idx}, 1)">+</button>
          </td>
          <td>Rs ${subtotal}</td>
          <td><button class="remove-btn" onclick="removeFromCart(${idx})">Remove</button></td>
        </tr>`;
      });
      html += '</tbody></table>';
      wrapper.innerHTML = html;
      document.getElementById('cartTotal').textContent = total;

      // prepare readable orderDetails text for Web3Forms/email
      const orderTextLines = cart.map(it => `${it.name} â€” Rs ${it.price} Ã— ${it.quantity} = Rs ${it.price * it.quantity}`);
      const orderText = orderTextLines.join("\\n") + "\\nTotal: Rs " + total;
      document.getElementById('orderDetails').value = orderText;
    }

    // Add product to cart
    function addToCart(name, price, img = '') {
      const idx = cart.findIndex(i => i.name === name && i.price === price);
      if (idx > -1) {
        cart[idx].quantity += 1;
      } else {
        cart.push({ name, price, img, quantity: 1 });
      }
      saveCart();
      // small confirmation (you can remove alert if you don't want)
      alert(name + ' added to cart');
    }

    // change qty
    function changeQty(index, delta) {
      if (!cart[index]) return;
      cart[index].quantity += delta;
      if (cart[index].quantity <= 0) cart.splice(index, 1);
      saveCart();
    }

    // remove item
    function removeFromCart(index) {
      cart.splice(index, 1);
      saveCart();
    }

    // Cart modal open/close
    const cartModal = document.getElementById('cartModal');
    document.getElementById('openCartBtn').addEventListener('click', () => {
      updateCartUI();
      cartModal.style.display = 'flex';
    });

    function openCart() {
      updateCartUI();
      cartModal.style.display = 'flex';
    }
    function closeCart() {
      cartModal.style.display = 'none';
    }

    // Close modal when clicking outside modal-content
    window.addEventListener('click', (e) => {
      if (e.target === cartModal) cartModal.style.display = 'none';
      if (e.target === document.getElementById('descModal')) closeDescription();
    });

    // Description modal
    function openDescription(title, text, price) {
      document.getElementById('descTitle').innerText = title;
      document.getElementById('descText').innerText = text;
      if (price) document.getElementById('descPrice').innerText = price;
      document.getElementById('descModal').style.display = 'flex';
    }
    function closeDescription() {
      document.getElementById('descModal').style.display = 'none';
    }

    function escapeHtml(str) {
      if (!str) return '';
      return String(str).replace(/[&<>"']/g, function (m) {
        return ({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;' })[m];
      });
    }

    // initial UI update on load
    document.addEventListener('DOMContentLoaded', () => {
      updateCartUI();
    });

    // Optional: clear cart after successful submission.
    // We cannot reliably detect server success from client-side because it posts to Web3Forms.
    // If you set redirect in the form to a thankyou page, that page can clear localStorage with JS:
    // localStorage.removeItem('bhc_cart');
  </script>
</body>
</html>
